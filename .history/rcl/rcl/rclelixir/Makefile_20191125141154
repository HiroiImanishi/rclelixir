CC		= gcc
TARGET	= init.so
DEST	= ./lib
ROOTDIR = ../../..
RCLDIR	= ..
SRCDIR	= ./nif_src
CFLAGS  = -O3 -fpic -shared
LINK = -lstdc++
INCLUDE	= -I. -I /usr/lib/erlang/erts-10.5.2/include -I $(RCLDIR)/include -I $(ROOTDIR)/rcutils/include -I $(ROOTDIR)/rmw/rmw/include -I ../../../../rosidl/rosidl_generator_c/include -I ../../../../rosidl/rosidl_typesupport_interface/include -I ../../../../rmw_fastrtps/rmw_fastrtps_cpp/include -I ../../../..

all:$(TARGET)

$(TARGET): 
	$(CC) $(CFLAGS) $(INCLUDE) -o $(DEST)$(TARGET) $(SRCDIR)/init_nif.c \
	$(RCLDIR)/src/rcl/init_options.c $(ROOTDIR)/rcutils/src/error_handling.c ../../src/rcl/context.c ../../src/rcl/arguments.c ../../../../rcutils/src/logging.c ../../../../rcutils/src/time.c ../../../../rcutils/src/string_map.c ../../../../rcutils/src/allocator.c ../../src/rcl/lexer_lookahead.c ../../../../rcutils/src/char_array.c ../../../../rcutils/src/strdup.c ../../../../rcutils/src/time_unix.c ../../../../rmw_fastrtps/rmw_fastrtps_cpp/src/rmw_init.cpp ../../../../rmw_fastrtps/rmw_fastrtps_cpp/src/identifier.cpp ../../../../rcl/rcl/src/rcl/remap.c ../../../../rcutils/src/get_env.c ../../../../rcl/rcl/src/rcl/expand_topic_name.c ../../../../rmw/rmw/src/validate_namespace.c ../../../../rmw/rmw/src/init.c ../../../../rmw/rmw/src/allocators.c \
	$(LINK)

